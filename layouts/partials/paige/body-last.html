<script>
  if (window.netlifyIdentity) {
    window.netlifyIdentity.on("init", user => {
      if (!user) {
        window.netlifyIdentity.on("login", () => {
          document.location.href = "/admin/";
        });
      }
    });
    // Handle invite/recovery tokens - open the identity widget to set password
    const hash = window.location.hash;
    if (hash && (hash.includes("invite_token") || hash.includes("confirmation_token") || hash.includes("recovery_token"))) {
      window.netlifyIdentity.open();
    }
  }
</script>
