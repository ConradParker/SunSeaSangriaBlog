<script>
  if (window.netlifyIdentity) {
    window.netlifyIdentity.on("init", user => {
      if (!user) {
        window.netlifyIdentity.on("login", () => {
          document.location.href = "/admin/";
        });
      }
    });
    // Handle invite/recovery tokens - redirect to admin which handles it better
    const hash = window.location.hash;
    if (hash && (hash.includes("invite_token") || hash.includes("confirmation_token") || hash.includes("recovery_token"))) {
      // Redirect to admin page with the hash - Decap CMS handles tokens better
      window.location.href = "/admin/" + hash;
    }
  }
</script>
